actor:
  model:
    model_type: openpi
    model_path: /mnt/pfs/scalelab/ziqianwang/models/RLinf-Pi05-SFT
    precision: null
    num_action_chunks: 4
    action_dim: 7
    is_lora: false
    lora_rank: 32
    use_proprio: true
    num_steps: 4
    add_value_head: false
    openpi:
      config_name: pi05_libero
      num_images_in_input: 2
      noise_level: 0.5
      action_chunk: 4
      num_steps: 4
      train_expert_only: true
      action_env_dim: 7
      noise_method: flow_sde
      add_value_head: false
      detach_critic_input: false
      cfm_enabled: true
      cfm_loss_weight: 0.25
      cfm_alpha: 1.0
      cfm_delta_t: 0.001
      cfm_time_eps: 0.001
      cfm_boundary_threshold: 0.9
      cfm_num_inference_steps: 2
  fsdp_config:
    strategy: fsdp
    sharding_strategy: no_shard
    gradient_checkpointing: false
    cpu_offload: false
    offload_pin_memory: false
    reshard_after_forward: true
    enable_gradient_accumulation: true
    forward_prefetch: false
    limit_all_gathers: false
    backward_prefetch: null
    use_orig_params: true
    use_liger_kernel: false
    fsdp_size: -1
    mixed_precision:
      param_dtype: null
      reduce_dtype: null
      buffer_dtype: null
    amp:
      enabled: false
      precision: bf16
      use_grad_scaler: false
  group_name: ActorGroup
  training_backend: fsdp
  micro_batch_size: 128
  global_batch_size: 512
  seed: 0
  optim:
    lr: 0.0002
    value_lr: 0.000155
    adam_beta1: 0.9
    adam_beta2: 0.95
    adam_eps: 1.0e-05
    weight_decay: 0.01
    clip_grad: 1.0
cluster:
  num_nodes: 1
  component_placement:
    actor,env,rollout: 0-3
runner:
  task_type: sft
  logger:
    log_path: ../results
    project_name: rlinf
    experiment_name: cfm_sft_openpi
    logger_backends:
    - tensorboard
    - wandb
  max_epochs: 1000
  max_steps: 200000
  val_check_interval: 1000
  save_interval: 10000
data:
  data_path: /mnt/pfs/scalelab/hf_cache/lerobot/physical-intelligence/libero
algorithm:
  adv_type: gae
reward:
  use_reward_model: false
critic:
  use_critic_model: false
